{"version":3,"file":"filter.min.js","sources":["../src/filter.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * JS module for the AMOS translator filter.\n *\n * @module      local_amos/filter\n * @copyright   2020 David Mudr√°k <david@moodle.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {debounce} from 'core/utils';\nimport {get_string as getString} from 'core/str';\nimport * as PubSub from 'core/pubsub';\nimport FilterEvents from './filter_events';\nimport TranslatorEvents from './translator_events';\n\nlet globalComponentsSelectorRowsCache = new Map();\nlet globalLanguageSelectorOptionsCache = [];\n\n/**\n * Initialise the module and register events handlers.\n *\n * @function init\n */\nexport const init = () => {\n    populateDOMElementCaches();\n    registerEventListeners();\n    updateCounterOfSelectedComponents();\n    updateCounterOfSelectedLanguages();\n    showUsedAdvancedOptions();\n    scrollToFirstSelectedComponent();\n};\n\n/**\n * @function populateDOMElementCaches\n */\nconst populateDOMElementCaches = () => {\n\n    // Create a cache map of all rendered component rows, keyed by the lowercase component name.\n    document.getElementById('amosfilter_fcmp_items_table').querySelectorAll(':scope tr').forEach((row, index) => {\n        let rowLabel = row.querySelector('label[for^=\"amosfilter_fcmp_f_\"]');\n        let mapKey = 'HEADING_' + index;\n\n        if (rowLabel) {\n            mapKey = rowLabel.innerText.toString().toLowerCase();\n        }\n\n        globalComponentsSelectorRowsCache.set(mapKey, row);\n    });\n\n    globalLanguageSelectorOptionsCache = document.getElementById('amosfilter_flng').querySelectorAll(':scope option');\n};\n\n/**\n * @function registerEventListeners\n */\nconst registerEventListeners = () => {\n    let root = document.getElementById('amosfilter');\n    let fcmp = document.getElementById('amosfilter_fcmp');\n    let componentSearch = document.getElementById('amosfilter_fcmp_search');\n    let languageSearch = document.getElementById('amosfilter_flng_search');\n    let fver = document.getElementById('amosfilter_fver');\n    let flast = document.getElementById('amosfilter_flast');\n    let ftxn = document.getElementById('amosfilter_ftxn');\n    let ftxe = document.getElementById('amosfilter_ftxe');\n\n    // Click event delegation.\n    root.addEventListener('click', e => {\n        if (!e.target.hasAttribute('data-action')) {\n            return;\n        }\n\n        let action = e.target.getAttribute('data-action');\n        let region = e.target.closest('[data-region]').getAttribute('data-region');\n\n        if (region == 'amosfilter_fcmp') {\n            handleComponentSelectorAction(e, fcmp, action);\n        }\n\n        if (region == 'amosfilter_buttons' && action == 'togglemoreoptions') {\n            toggleMoreOptions(e, root);\n        }\n\n        if (region == 'amosfilter_buttons' && action == 'submit') {\n            e.preventDefault();\n            e.target.blur();\n            document.getElementById('amosfilter_fpg').value = 1;\n            submitFilter();\n        }\n    });\n\n    // Input change event delegation.\n    root.addEventListener('change', e => {\n        if (e.target.id.startsWith('amosfilter_fcmp_')) {\n            updateCounterOfSelectedComponents();\n        }\n\n        if (e.target.id == 'amosfilter_flng') {\n            updateCounterOfSelectedLanguages();\n        }\n\n        if (e.target.id == 'amosfilter_flast') {\n            if (flast.checked) {\n                fver.setAttribute('disabled', 'disabled');\n            } else {\n                fver.removeAttribute('disabled');\n            }\n        }\n\n        if (e.target.id == 'amosfilter_ftxn') {\n            if (!ftxn.checked && !ftxe.checked) {\n                ftxe.checked = true;\n                return;\n            }\n        }\n\n        if (e.target.id == 'amosfilter_ftxe') {\n            if (!ftxn.checked && !ftxe.checked) {\n                ftxn.checked = true;\n                return;\n            }\n        }\n    });\n\n    // Pagination clicks.\n    PubSub.subscribe(TranslatorEvents.pagechange, page => {\n        document.getElementById('amosfilter_fpg').value = page;\n        submitFilter();\n    });\n\n    // Prevent form submission on pressing Enter in the component search and language input.\n    [componentSearch, languageSearch].forEach(inputField => {\n        inputField.addEventListener('keypress', e => {\n            if (e.keyCode == 13) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        });\n    });\n\n    // Handle component search.\n    componentSearch.addEventListener('input', debounce(() => {\n        handleComponentSearch(componentSearch);\n    }, 200));\n\n    // Handle language search.\n    languageSearch.addEventListener('input', debounce(() => {\n        handleLanguageSearch(languageSearch);\n    }, 200));\n};\n\n/**\n * @function handleComponentSelectorAction\n * @param {Event} e\n * @param {Element} fcmp\n * @param {string} action\n */\nconst handleComponentSelectorAction = (e, fcmp, action) => {\n\n    let selectorComponentItem = `:scope [data-region=\"amosfilter_fcmp_item\"]:not(.hidden) input[name=\"fcmp[]\"]`;\n    document.getElementById('amosfilter_fapp').checked = false;\n    document.getElementById('amosfilter_fworkplace').checked = false;\n\n    if (action == 'selectstandard') {\n        e.preventDefault();\n        fcmp.querySelectorAll(`${selectorComponentItem}`).forEach(item => {\n            var type = item.getAttribute('data-component-type');\n            item.checked = (type == 'core' || type == 'standard');\n        });\n    }\n\n    if (action == 'selectadditional') {\n        e.preventDefault();\n        fcmp.querySelectorAll(`${selectorComponentItem}`).forEach(item => {\n            var type = item.getAttribute('data-component-type');\n            item.checked = (type == 'contrib');\n        });\n    }\n\n    if (action == 'selectworkplace' || action == 'selectapp') {\n        e.preventDefault();\n        let selectedcomponent = '';\n\n        switch (action) {\n            case 'selectworkplace':\n                selectedcomponent = 'workplace';\n                break;\n            case 'selectapp':\n                selectedcomponent = 'app';\n                break;\n        }\n\n        fcmp.querySelectorAll(`${selectorComponentItem}`).forEach(item => {\n            item.checked = item.hasAttribute('data-component-' + selectedcomponent);\n        });\n\n        document.getElementById('amosfilter_f' + selectedcomponent).checked = true;\n        showUsedAdvancedOptions();\n    }\n\n    if (action == 'selectall') {\n        e.preventDefault();\n        fcmp.querySelectorAll(`${selectorComponentItem}`).forEach(item => {\n            item.checked = true;\n        });\n    }\n\n    if (action == 'selectnone') {\n        e.preventDefault();\n        fcmp.querySelectorAll(`${selectorComponentItem}`).forEach(item => {\n            item.checked = false;\n        });\n    }\n\n    updateCounterOfSelectedComponents();\n};\n\n/**\n * @function handleComponentSearch\n * @param {Element} inputField\n */\nconst handleComponentSearch = (inputField) => {\n\n    let needle = inputField.value.toString().replace(/^ +| +$/, '').toLowerCase();\n    let shadowTableBody = document.createElement('tbody');\n\n    globalComponentsSelectorRowsCache.forEach((row, key) => {\n        if (key.startsWith('HEADING')) {\n            shadowTableBody.appendChild(row);\n            return;\n        }\n\n        if (needle == '' || key.indexOf(needle) !== -1) {\n            shadowTableBody.appendChild(row);\n            return;\n        }\n    });\n\n    let fcmpItemTable = document.getElementById('amosfilter_fcmp_items_table');\n    fcmpItemTable.innerHTML = '';\n    fcmpItemTable.appendChild(shadowTableBody);\n};\n\n/**\n * @function updateCounterOfSelectedComponents\n */\nconst updateCounterOfSelectedComponents = () => {\n    let fcmp = document.getElementById('amosfilter_fcmp');\n    let counter = document.getElementById('amosfilter_fcmp_counter');\n    let invalidfeedback = document.getElementById('amosfilter_fcmp_invalid_feedback');\n    let count = fcmp.querySelectorAll(':scope input[name=\"fcmp[]\"]:checked').length;\n\n    if (count == 0) {\n        counter.classList.add('badge-danger');\n        fcmp.classList.add('is-invalid');\n        invalidfeedback.classList.remove('hidden');\n    } else {\n        counter.classList.remove('badge-danger');\n        fcmp.classList.remove('is-invalid');\n        invalidfeedback.classList.add('hidden');\n    }\n\n    counter.textContent = count;\n};\n\n/**\n * @function handleLanguageSearch\n * @param {Element} inputField\n */\nconst handleLanguageSearch = (inputField) => {\n    let needle = inputField.value.toString().replace(/^ +| +$/, '').toLowerCase();\n\n    globalLanguageSelectorOptionsCache.forEach(item => {\n        if (needle == '' || item.text.toString().toLowerCase().indexOf(needle) !== -1) {\n            item.classList.remove('hidden');\n            // It is not enough to hide the options, because block-select (via select) would select hidden intermediate options too.\n            // So we need to disable them.\n            item.removeAttribute('disabled');\n        } else {\n            item.classList.add('hidden');\n            item.setAttribute('disabled', 'disabled');\n        }\n    });\n};\n\n/**\n * @function updateCounterOfSelectedLanguages\n */\nconst updateCounterOfSelectedLanguages = () => {\n    let flng = document.getElementById('amosfilter_flng');\n    let counter = document.getElementById('amosfilter_flng_counter');\n    let invalidfeedback = document.getElementById('amosfilter_flng_invalid_feedback');\n    let count = flng.querySelectorAll(':scope option:checked').length;\n\n    if (count == 0) {\n        counter.classList.add('badge-danger');\n        flng.classList.add('is-invalid');\n        invalidfeedback.classList.remove('hidden');\n    } else {\n        counter.classList.remove('badge-danger');\n        flng.classList.remove('is-invalid');\n        invalidfeedback.classList.add('hidden');\n    }\n\n    counter.textContent = count;\n};\n\n/**\n * @function toggleMoreOptions\n * @param {Event} e\n * @param {Element} root\n */\nconst toggleMoreOptions = async(e, root) => {\n    e.preventDefault();\n\n    if (root.getAttribute('data-level-showadvanced') == '0') {\n        root.setAttribute('data-level-showadvanced', 1);\n        e.target.innerText = await getString('lessfilteringoptions', 'local_amos');\n\n    } else {\n        root.setAttribute('data-level-showadvanced', 0);\n        e.target.innerText = await getString('morefilteringoptions', 'local_amos');\n        showUsedAdvancedOptions();\n    }\n};\n\n/**\n * Make advanced options that have been set, visible even in basic mode.\n *\n * @function showUsedAdvancedOptions\n */\nconst showUsedAdvancedOptions = () => {\n    let root = document.getElementById('amosfilter');\n\n    root.querySelectorAll(':scope [data-level=\"advanced\"][data-level-control]').forEach(item => {\n        let control = document.getElementById(item.getAttribute('data-level-control'));\n        let forceshow = false;\n\n        if (control.tagName.toLowerCase() == 'input'\n                && control.getAttribute('type') == 'checkbox'\n                && control.checked) {\n            forceshow = true;\n        }\n\n        if (control.tagName.toLowerCase() == 'input'\n                && control.getAttribute('type') == 'text'\n                && control.value !== '') {\n            forceshow = true;\n        }\n\n        if (control.tagName.toLowerCase() == 'select'\n                && control.hasAttribute('data-default')\n                && !control.hasAttribute('disabled')) {\n            let selected = control.querySelectorAll(':scope option:checked');\n\n            if (selected.length != 1) {\n                forceshow = true;\n\n            } else {\n                selected.forEach(option => {\n                    if (option.value !== control.getAttribute('data-default')) {\n                        forceshow = true;\n                    }\n                });\n            }\n        }\n\n        if (forceshow) {\n            item.setAttribute('data-level-forceshow', 1);\n        } else {\n            item.removeAttribute('data-level-forceshow');\n        }\n    });\n\n    root.querySelectorAll(':scope [data-level=\"advanced\"][data-level-control]').forEach(item => {\n        let control = document.getElementById(item.getAttribute('data-level-control'));\n\n        if (control.tagName.toLowerCase() == 'fieldset') {\n            if (control.querySelector('[data-level-forceshow]')) {\n                item.setAttribute('data-level-forceshow', 1);\n            } else {\n                item.removeAttribute('data-level-forceshow');\n            }\n        }\n    });\n};\n\n/**\n * @function scrollToFirstSelectedComponent\n */\nconst scrollToFirstSelectedComponent = () => {\n    let comp = document.getElementById('amosfilter_fcmp').querySelector('input[id^=\"amosfilter_fcmp_f_\"]:checked');\n\n    if (comp) {\n        comp.scrollIntoView(false);\n    }\n};\n\n/**\n * @function submitFilter\n */\nconst submitFilter = () => {\n    let root = document.getElementById('amosfilter');\n    let flng = document.getElementById('amosfilter_flng');\n    let loadingIndicator = document.getElementById('amosfilter_loading_indicator');\n    let languageSearch = document.getElementById('amosfilter_flng_search');\n\n    loadingIndicator.classList.remove('hidden');\n\n    // Temporarily enable all language selector options to make sure that selected ones are submitted.\n    flng.querySelectorAll(':scope option').forEach(item => {\n        item.removeAttribute('disabled');\n    });\n\n    let form = root.querySelector('form');\n    let formdata = new FormData(form);\n\n    // Put the language selector into original state again (disable all hidden options).\n    handleLanguageSearch(languageSearch);\n\n    formdata.delete('sesskey');\n    PubSub.publish(FilterEvents.submit, new URLSearchParams(formdata).toString());\n};\n"],"names":["globalComponentsSelectorRowsCache","Map","globalLanguageSelectorOptionsCache","populateDOMElementCaches","registerEventListeners","updateCounterOfSelectedComponents","updateCounterOfSelectedLanguages","showUsedAdvancedOptions","scrollToFirstSelectedComponent","document","getElementById","querySelectorAll","forEach","row","index","rowLabel","querySelector","mapKey","innerText","toString","toLowerCase","set","root","fcmp","componentSearch","languageSearch","fver","flast","ftxn","ftxe","addEventListener","e","target","hasAttribute","action","getAttribute","region","closest","handleComponentSelectorAction","toggleMoreOptions","preventDefault","blur","value","submitFilter","id","startsWith","checked","setAttribute","removeAttribute","PubSub","subscribe","TranslatorEvents","pagechange","page","inputField","keyCode","stopPropagation","handleComponentSearch","handleLanguageSearch","selectorComponentItem","item","type","selectedcomponent","needle","replace","shadowTableBody","createElement","key","appendChild","indexOf","fcmpItemTable","innerHTML","counter","invalidfeedback","count","length","classList","add","remove","textContent","text","flng","async","control","forceshow","tagName","selected","option","comp","scrollIntoView","loadingIndicator","form","formdata","FormData","delete","publish","FilterEvents","submit","URLSearchParams"],"mappings":"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"}